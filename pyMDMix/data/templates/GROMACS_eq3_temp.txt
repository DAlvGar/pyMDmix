;---------------------------------------------
;---------------------------------------------
; RUN CONTROL
;---------------------------------------------
;---------------------------------------------
integrator               = md                       ; leap-frog algorithm for Newton eq.
tinit                    = 0
dt                       = $timestep                    ; in ps
nsteps                   = $nsteps                  ; 5.00   ns
init-step                = 0
;----------------------------------
xtc-grps                 = System
$maskfield                 ; position restrain the protein and the ligand
;----------------------------------
; COM (center of mass) parameters
;----------------------------------
comm-mode                = Linear                   ; remove COM translation     
nstcomm                  = 100
comm-grps                = System


;----------------------------------------------
;----------------------------------------------
; NEIGHBORSEARCHING 
;----------------------------------------------
;----------------------------------------------
cutoff-scheme            = verlet                   ; group/verlet (check Elec/VdW)
nstlist                  = 10                       ;-1 for WTE!
nstcalcenergy            = 10                       ; 1 for WTE!
ns-type                  = grid                     ; search neighboring grid cells
pbc                      = xyz                      ; 3-D PBC
periodic-molecules       = no
rlist                    = 1.2
rlistlong                = -1


;----------------------------------------------
;----------------------------------------------
; ELECTROSTATICS
;----------------------------------------------
;----------------------------------------------
coulombtype              = PME                      ; PME for long-range electrostatics (or PME-Switch w/o Verlet)
rcoulomb                 = 1.2                      ; short-range electrostatic cutoff (in nm) - 1 for Switch
rcoulomb-switch          = 0                        ; 0.95 for Switch


;---------------------------------------------
;---------------------------------------------
; VDW
;---------------------------------------------
;---------------------------------------------
vdwtype                  = Cutoff                   ; or Shift w/o Verlet
rvdw                     = 1.2                      ; short-range van der Waals cutoff (in nm) - 1 for Switch
rvdw-switch              = 0                        ; 0.8 for Switch
DispCorr                 = EnerPres                 ; account for cut-off vdW scheme


;---------------------------------------------
;---------------------------------------------
; OPTIONS FOR PME/EWALD
;----------------------------------------------
;----------------------------------------------
fourierspacing           = 0.12                     ; grid spacing for FFT
fourier-nx               = 0
fourier-ny               = 0
fourier-nz               = 0
pme-order                = 4                        ; cubic interpolation
ewald-rtol               = 1e-5
ewald-geometry           = 3d
epsilon-surface          = 0
optimize-fft             = yes


;----------------------------------------------
;----------------------------------------------
; OPTIONS FOR WEAK COUPLING ALGORITHMS
;----------------------------------------------
;----------------------------------------------
; Temperature coupling
;----------------------------------
tcoupl                   = v-rescale                ; modified Berendsen thermostat
nsttcouple               = -1
nh-chain-length          = 10
;tc-grps                 = system
tc-grps                  = solute solvent ; two coupling groups - more accurate
;tau-t                   = 0.1
tau_t                    = 0.1     0.1              ; time constant, in ps
;ref-t                   = $temp
ref_t                    = $temp     $temp              ; reference temperature, one for each group, in K
;----------------------------------
; Pressure coupling
;----------------------------------
pcoupl                   = Parrinello-Rahman        ; Pressure coupling on in NPT
pcoupltype               = isotropic                ; uniform scaling of box vectors
nstpcouple               = -1
tau-p                    = 2
compressibility          = 4.5e-5                   ; isothermal compressibility of water, bar^-1
ref-p                    = 1.0                      ; reference pressure, in bar
refcoord_scaling         = com


;----------------------------------------------
;----------------------------------------------
; VELOCITY GENERATION
;----------------------------------------------
;----------------------------------------------
gen-vel                  = no
;gen-temp                = $temp                      ; only if gen-vel is on


;----------------------------------------------
;----------------------------------------------
; OPTIONS FOR BONDS
;----------------------------------------------
;----------------------------------------------
constraints              = H-bonds                ; all bonds (even heavy atom-H bonds) constrained
constraint-algorithm     = Lincs                    ; holonomic constraints
;continuation            = yes                      ; Restarting after NPT-1
;----------------------------------
; Number of iterations in the final step of LINCS. (1 = normal, 2 = NVE, 4-8 = minimization)
;----------------------------------
lincs-order              = 4                        ; also related to accuracy
lincs-iter               = 1                        ; accuracy of LINCS
lincs-warnangle          = 30


;----------------------------------------------
;----------------------------------------------
; OUTPUT CONTROL OPTIONS
;----------------------------------------------
;----------------------------------------------
; Output frequency for coords (x), vel (v) and forces (f)
;----------------------------------
nstxout                  = $freq                     ; save coordinates every 10.0 ps
nstvout                  = $freq                     ; save velocities every 10.0 ps
nstfout                  = 0
;----------------------------------
; Output frequency for energies to log file and energy file
;----------------------------------
nstlog                   = $freq                     ; update log file every 10.0 ps
nstenergy                = $freq                     ; save energies every 2.0 ps
;----------------------------------
; Output frequency and precision for .xtc file
;----------------------------------
nstxout-compressed       = $freq                     ; save xtc every 10.0 ps
;xtc-precision           = 1000


